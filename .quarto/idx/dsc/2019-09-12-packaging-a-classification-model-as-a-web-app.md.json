{"title":"Packaging a classification model as a web app","markdown":{"yaml":{"title":"Packaging a classification model as a web app","date":"2019-09-12","categories":["blogs"]},"headingText":"Exporting the model for later use","containsRefs":false,"markdown":"\n\n[![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-13-03-18.png?w=1024)](https://zebra-vs-elephant.onrender.com)\n\nMy shiny new web app, available [here](https://zebra-vs-elephant.onrender.com)\n\nIn my [previous post](https://datasciencecastnet.home.blog/2019/09/06/pothole-detection-aka-johno-tries-fastai/) I introduced fastai, and used it to identify images with potholes. Since then, I've applied the same basic approach to the [Standard Bank Tech Impact Challenge: Animal classification](https://zindi.africa/competitions/sbtic-animal-classification) with pretty decent results. A first, rough model was able to score 97% accuracy thanks to the magic of transfer learning, and by unfreezing the inner layers and re-training with a lower learning rate I was able to up the accuracy to over 99% for this binary classification problem. It still blows my mind how good these networks are at computer vision.\n\n![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-11-36-03.png?w=840)\n\nZebra or Elephant?\n\nThis was exciting and fun. But I wanted to share the result, and my peer group aren't all that familiar with log-loss scores. How could I get the point across and communicate what this means? Time to deploy this model as a web application :)\n\n\n![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-16-32-31.png?w=399)\n\nFinal training step, saving weights and exporting to a file in my Google Drive\n\nI knew it was possible to save some of the model parameters with model.save('name'), but wasn't sure how easy it would be to get a complete model definition. Turns out, enough people want this that you can simply call model.export('model\\_name'). So I set my model training again (I hadn't saved last time) and started researching my next step while Google did my computing for me.\n\n## Packaging as an app\n\nI expected this step to be rather laborious. I'd need to set up a basic app (planned to use Flask), get an environment with pytorch/fastai set up and deploy to a server or, just maybe, get it going on Heroku. But then I came across an exciting page in the fastai docs: '[Deploying on Render](https://course.fast.ai/deployment_render.html)'. There are essentially 3 steps:  \n\\- Fork the example repository  \n\\- Edit the file to add a link to your exported model  \n\\- Sign up with Render and point it at your new GitHub repository.  \nThen hit deploy! You can read about the full process in the [aforementioned tutorial](https://course.fast.ai/deployment_render.html). Make sure your fastai is a recent version, and that you export the model (not just saving weights).\n\nThe resultant app is available at [zebra-vs-elephant.onrender.com](https://zebra-vs-elephant.onrender.com). I used an earlier model with 97% accuracy (since I'm enjoying that top spot on the leaderboard ;)) but it's still surprisingly accurate. It even get's cartoons right!\n\n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-12-08-38.png?w=496)\n    \n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-12-08-57.png?w=403)\n    \n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-13-00-29.png?w=352)\n    \n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-13-00-43.png?w=414)\n    \n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/classify2.jpeg?w=270)\n    \n- ![](https://datasciencecastnethome.files.wordpress.com/2019/09/classify3.jpeg?w=281)\n    \n\nPlease try it out and let me know what you think. It makes a best guess - see what it says for non-animals, or flatter your friends by classifying them as pachyderms.\n\n## Conclusion\n\nThere seems to be a theme to my last few posts: \"Things that sound hard are now easy!\". It's an amazing world we live in. You can make something like this! It took 20 minutes, with me doing setup while the model trained! Comment here with links to your sandwich-or-not website, your am-I-awake app, your 'ask-a-computer-if-this-dolphin-looks-happy' business idea. Who knows, one of us might even make something useful :)\n\n![](https://datasciencecastnethome.files.wordpress.com/2019/09/screenshot-from-2019-09-12-16-56-03.png?w=386)\n\nYes, that is apparently an elephant...\n\nUPDATE: I've suspended the service for now, but can re-start it if you'd like to try it. Reach out if that's the case :)\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"2019-09-12-packaging-a-classification-model-as-a-web-app.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"cosmo","title":"Packaging a classification model as a web app","date":"2019-09-12","categories":["blogs"]},"extensions":{"book":{"multiFile":true}}}}}