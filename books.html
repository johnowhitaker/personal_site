<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>johnowhitaker.dev – Book Recommendations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="johnowhitaker.dev - Book Recommendations">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@johnowhitaker">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./all.html"> 
<span class="menu-text">Everything Feed</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="./tils.html">
 <span class="dropdown-text">TILs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./blog.html">
 <span class="dropdown-text">Blog Archive</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resume.html">
 <span class="dropdown-text">Resume: Jonathan Whitaker</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./books.html">
 <span class="dropdown-text">Book Recommendations</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link active" data-scroll-target="#recommendations">Recommendations</a></li>
  <li><a href="#others-wip" id="toc-others-wip" class="nav-link" data-scroll-target="#others-wip">Others (WIP)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Book Recommendations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="recommendations" class="level2">
<h2 class="anchored" data-anchor-id="recommendations">Recommendations</h2>
<p>I like recommending books to other people, and find that the best way to get good new recommendations is to find someone with overlapping tastes and then look for ones they like that I haven’t read yet. In that spirit, here are some books/authors I’ve enjoyed that I can recommend:</p>
<section id="sci-fi" class="level4">
<h4 class="anchored" data-anchor-id="sci-fi">Sci-fi:</h4>
<ul>
<li>Anything by Asimov, anything by Douglas Adams (classics)</li>
<li>Anything by John Scalzi. “Lock In” if you want more gritty detective action, “Do Androids Dream of Electric Sheep” for something more absurd and funny, “old man’s war” for a good series</li>
<li>The Three Body Problem (dark forest trilogy) by Cixin Liu is excellent sci-fi from a different perspective, loved it</li>
<li>Seveneves by Neal Stevenson is great, as is lots of his other work</li>
<li>The Martian and its sequels are fun, by Andy Weir</li>
</ul>
</section>
<section id="fantasy" class="level4">
<h4 class="anchored" data-anchor-id="fantasy">Fantasy:</h4>
<ul>
<li>I like the Stormlight series from Brandon Sanderson.</li>
<li>Discworld series by Pratchett</li>
</ul>
</section>
<section id="non-fiction" class="level4">
<h4 class="anchored" data-anchor-id="non-fiction">Non-fiction:</h4>
<ul>
<li>The Righteous Mind: a fantastic book for understanding morality+religion. Can’t recommend this highly enough. If you skip the book at least read his paper “The Emotional Dog and its Rational Tail”.</li>
<li>Reality + by David Chalmers: philosophy of mind through a modern lens, great overview of lots of philosophy topics and an excellent defence of simulation realism</li>
<li>An Immense World by Ed Young, one of my favorite books. Animal senses and how their words differ from ours. Mind expanding.</li>
<li>The Seabird’s Cry. Poignant look at amazing creatures and how we’re changing their world, with a very poetic author.</li>
<li>I am a strange loop: Fun to see someone tackle an ambitious question for a second time (this is the same author as Godel, Escher, Bach). Be prepared for many long diversions and analogies as he tries to make his meaning unambiguous.</li>
</ul>
</section>
</section>
<section id="others-wip" class="level2">
<h2 class="anchored" data-anchor-id="others-wip">Others (WIP)</h2>
<p>In no particular order, here are a bunch of others I’ve read. As I read more I’m adding them to the top of this list, with mini-reviews. The bulk of the list is still just me trying to remember as many as possible, and should grow + become more orderly over time.</p>
<ul>
<li>Winds Twelve Quarters (Ursula K. Le Guin) - fantasticx short stories, I really enjoy her work.</li>
<li>Fractal Noise - A ‘short story’ that is maybe longer than it needs to be, although in his defence he’d just written the Eragon series.</li>
<li>Lock In (John Scalzi) - Thrilling detective story in a fun world, both it and the sequel were fun to re-visit amid the online speculation re: Neuralink and the general AI discourse even though the main plot isn’t much focused on the tech.</li>
<li>What We Owe The Future. I finally read this after being a little frustrated with some longtermist takes. Annoyingly, Will is more reasonable than the loonies and the book was fairly interesting and well-written. I think I would have enjoyed it more if I hadn’t already been over the ideas a ton - if you’re less familiar with the ground it might be a good intro to this patch of philosophy and population ethics.</li>
<li>The Tale of the Dueling Neurosurgeons (Sam Kean). This author writes history very well - the parade of case-studies can get a little tiring but you do get sucked into the individual stories alongside a healthy dose of neuroscience (albeit not extremely deep technically).</li>
<li>At The Existentialist Cafe (Sarah Bakewell). TODO.</li>
<li>Old Man’s War (John Scalzi) A fun series, humanity in a ‘Starship Troopers’-like universe where you’re never quite sure if humans are really the baddies.</li>
<li>Going Zero (Anthony McCarten) Quick read, thanks to TITAA for the rec. Thriller, exploring surveillance and the dangers of power concentrated in the hands of SV elite types.</li>
<li>The Tao of Pooh. Great fun, worth a skim. The author has a very scathing view of scientists!</li>
<li>Determined (Robert Sapolsky). I enjoyed his course. The book is his ultimate debunk of the idea of free will, followed by an exploration of what that means in practice for how we should live. I enjoyed it but it’s snarkily written to the point of being off-putting for anyone not already on board with the idea - I don’t think this would be very useful for convincing someone to change their mind.</li>
<li>The Interdependency Trilogy (Scalzi). Future space civilizations, my least favourite of his. A few neat ideas, lots of inner thoughts of non-so-nice people.</li>
<li>The Kaiju Preservation society (Scalzi). A great read, very much in his style. Made me laugh out loud, which few authors manage. Also completely ridiculous but then this is Scalzi…</li>
<li>I Contain Multitudes (Ed Young). He writes really well. I was skeptical because ‘microbiome’ is so trendy, turns out this book started the craze and is a lot more measured and realistic than some subsequent hype. Hard not to get excited about bacteria after reading this :)</li>
<li>Klara and the Sun. Interesting book. Had me thinking a fair amount about how willing humans are to ascribe human-like intelligence and other qualities to very foreign things. See also: thinking jumping spiders are cute, pair-bonding with anything that has googley eyes. My family tried to turn this into a book club but stretched the discussion out too far. I did like his attempt to show Klara’s strange way of perceiving the world - how some things are, to her, obviously evil - much like my dog hates lawnmowers. Scary as we imagine future more competent yet foreign intelligences.</li>
<li>Entangled Life (Martin Sheldrake). Great read re: fungi, fun to get a picture of the author as your read through their work.</li>
<li>Strange Rites - New Religions for a Godless Age (author name). Fascinating dive into some contemporary ‘religions’, providing a useful lens for understanding a lot of things in the world today.</li>
<li>The Mistborn Trilogy (Brandon Sanderson). Not as good as his Stormlight series but I persevered. Worth a go if you’re fantasy-starved and like Sanderson.</li>
<li>Mindful Eating (Jan Chozen Bays). A reminder to slow down and savor things. A little weird and ‘extra’ but it’s their book, fair game.</li>
<li>Into the Wild (Jon Krakauer). A fascinating account of an interesting individual and his conflict with society. I’m always interested in anyone who refuses to walk the default path.</li>
<li>The Alchemist (Paulo Coelho). I fondly remember a teacher read this to us in junior school. Manifest destiny and all that - interesting to think about, and seemingly fairly popular, but easy to take too far.</li>
<li>“Happy Money: The Science of Smarter Spending” (Elizabeth Dunn, Michael Norton). Fun in a Freakonomics-wannabe sort of way. Take the book’s own recommendation to buy time by skipping reading it and instead just ask ChatGPT to summarize the key actionable ideas.</li>
<li>“All That the Rain Promises and More” (David Arora). A highly entertaining field guide for mushrooms, sprinkled with fantastic anecdotes and tasting notes. Mandatory for trips around Oregon!</li>
<li>DUNE (Frank Herbert) and sequels. Interesting and genre-defining in some ways. The sequels got a little too weird for me.</li>
<li>“The End of the World Is Just the Beginning” (Peter Zeihan). Read it because it challenges my optimistic outlook. Reveals a lot about the interdependence we have through globalization, and how fragile these systems are. And made me more aware of America and their role in the world.</li>
<li>How To Be A Stoic (Massimo Pugliochi???). I like Stoicism, and think it should be much more popular. The book does a good job giving actionable tips in addition to condensing key ideas.</li>
<li>Man’s Search for Meaning (Viktor Frankel) - Underwhelming given the praise I’ve seen for it, but does make the point well that humans seem to want meaning :shrug:</li>
<li>Are We Smart Enough to Know How Smart Animals Are? (Frans de Waal)</li>
<li>The Count of Monte Christo - loved this classic TODO re-read and review.</li>
<li>Discworld Series (Terry Pratchett). I’ve read all of these multiple times, such witty commentary on life.</li>
<li>Douglas Adams</li>
<li>Christopher Paolini</li>
<li>F.W. Dixon</li>
<li>Willard Price</li>
<li>Tolkein</li>
<li>Brian Jaques</li>
<li>Enid Blighton</li>
<li>Bill Bryson</li>
<li>Anthony Horowitz (Alex series)</li>
<li>Popco</li>
<li>Liveship trilogy</li>
<li>Guns, germs and steel (todo sequel ‘collapse’ to talk to FIL)</li>
<li>You are not so smart and sequel</li>
<li>Goosebumps (a handful)</li>
<li>CUrious incident of the dog in the nighttime</li>
<li>John Wyndham (midwich cuckoos, triffids, a few others)</li>
<li>White fang and the call of the wild Jack London</li>
<li>Chicken soup for the preteen soul</li>
<li>The bible (several re-reads, lots of excerpts)</li>
<li>Freakonomics and sequel</li>
<li>How to spend X and do Y bjorn lomberg</li>
<li>Shakespeare (a few) and tales from shakespeare (banger)</li>
<li>Ignition (great book)</li>
<li>Bell Labs: Innovation Factory great</li>
<li>Surely You’re Joking Mr Feynman (3+ reads, impactful)</li>
<li>6 easy pieces, 6 hard ones, QED by him too</li>
<li>A brief history of time and even briefer one</li>
<li>Astrophysics for people in a hurry</li>
<li>Skimmed thinking fast and slow, blink, think again and similar selg-help books</li>
<li>That crazy magical realism one about the SA village family</li>
<li>Tim Keller marriage book</li>
<li>That other marriage book</li>
<li>Bird book haha</li>
<li>The silent knife thing (lame)</li>
<li>The Hunger Games</li>
<li>That rip-off hunger games post apocalyptic one Ellie makes fun of</li>
<li>Make: the annotated build-it yourself</li>
<li>Making Embedded Systems</li>
<li>Laws guide to nature drawing and journalling</li>
<li>Reality +</li>
<li>P. G. Woodhouse (most if not all, several reads of Jeeves)</li>
<li>James Herriot (funny vet)</li>
<li>The doctor equivalent ‘A Doctor Abroad’ maybe?</li>
<li>Wilderness ways lovely</li>
<li>Gerrald Durrel problematic</li>
<li>The 100-year-old man who climbed out of his window and the sequel about the girl who saved the king of Sweden hilarious</li>
<li>The Rosie Project good laugh</li>
<li>Dr Seuss</li>
<li>S&gt;A&gt;S survival guide</li>
<li>Hatchett or something recd by E, that or my side of the mountain only one of the two</li>
<li>The Call of the wild (that guy who went into the woods)</li>
<li>Some Agatha Christie</li>
<li>Some Nancy drew maybe? Definitely a crossover with Hardy BOys IIRC</li>
<li>‘MLP: Friendship is optimal’ and some others on a weird list Hotz shared</li>
<li>That space series with a magical ship AI nanobots and such</li>
<li>‘Hothouse’ parasitic mind control scifi find author (I read several IIRC)</li>
<li>Scifi anthology</li>
<li>Science of the DIscworld</li>
<li>The Long Earth Series</li>
<li>The magic compass (trilogy, knife somethig something)</li>
<li>Ball Lightning and the Three Body trilogy</li>
<li>Sci-fi/horror theres a deep hole up come <em>wasps</em> or something, biological control for humans?</li>
<li>Outlive by Peter Attia</li>
<li>Eat food, not too much, mostly vegetables (Michael Pollen?)</li>
<li>Lab Girl (boring)</li>
<li>Three Men on a bummel</li>
<li>Once upo a river magical realism</li>
<li>Dandelion Wine (Ray Bradbury)</li>
<li>Farenheight 451</li>
<li>A Brave New World</li>
<li>Trooper Peter Halket?</li>
<li>Wet Breams and sequel elephant guy</li>
<li>That one with the SA people who owned a lion?</li>
<li>Oh that weird AI thinkpiece by Kissenger and co that didn’t say much</li>
<li>Public Health in mid-VIctorian Britain</li>
<li>Grades, Sub-grades and Subbases (or subsomethings at least)</li>
<li>South Africa’s Vanishing Waterways</li>
<li>Why_’s poignant Guide to Ruby</li>
<li>Pride and Prejudice</li>
<li>The Idea Factory, Bell Labs</li>
<li>Make: The Annotated DIY Science Laboratory (hilarious safety warnings)</li>
<li>Make: Tips and Tales from the workshop</li>
<li>Roberts Field Guide to Birds of Southern Africa</li>
<li>Windmills (Jaap’s book)</li>
<li>You are Not So Smart + You Are Now Less Dumb (also enjoyed the podcast)</li>
<li>Tales from Shakespeare (Charles Lamb) - fantastic re-telling of Shakespeare’s plays as short stories, keeping in many good quotes and otherwise adapting them very well.</li>
<li>1984</li>
<li>Tess of D’Uberville</li>
<li>Far from the madding crowd</li>
<li>Pride and Prejudice</li>
<li>Don Qiote (spelling?)</li>
<li>Jade City and possibly sequels</li>
<li>THe man who mistook his wife for a hat</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/johnowhitaker\.dev");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>